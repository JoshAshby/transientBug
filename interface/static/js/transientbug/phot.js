// Generated by CoffeeScript 1.5.0
(function() {

  $(function() {
    var tags, timeout, toggle;
    timeout = null;
    $("#pillbox").pillbox();
    tags = $.ajax({
      url: "/phots/tags/json",
      async: false
    });
    $('.pillbox input').typeahead({
      name: 'phots_tags',
      local: tags.responseJSON[0]["tags"],
      limit: 10
    });
    toggle = function(what) {
      var di, id;
      id = $(what).data("id");
      di = $("#" + id);
      return $.post("/admin/phots/" + id + "/toggle", function(data) {
        if (data[0]["success"]) {
          return window.location.reload();
        }
      });
    };
    $(document).on("click", ".confirm_btn", function() {
      return toggle(this);
    });
    $(document).on("click", ".nope_btn", function() {
      return $(".toggle_btn").popover('hide');
    });
    return $(".toggle_btn").click(function(e) {
      var id;
      e.preventDefault();
      id = $(this);
      $(".toggle_btn").not(this).popover('hide');
      $(this).popover('show');
      $(".popover").find(".confirm_btn").data("id", $(this).data("id"));
      timeout = setTimeout(function() {
        return id.popover('hide');
      }, 3000);
      return $(document).on("mouseenter", ".popover", function() {
        return clearTimeout(timeout);
      }).on("mouseleave", ".popover", function() {
        return timeout = setTimeout(function() {
          return id.popover('hide');
        }, 3000);
      });
    }).popover({
      trigger: "manual",
      placement: "auto right",
      html: true,
      content: '<div class="btn-group"><button class="btn btn-success btn-sm confirm_btn"><i class="fa fa-check"></i></button><button class="btn btn-default btn-sm nope_btn"><i class="fa fa-times"></i></button></div>',
      container: "body"
    });
  });

}).call(this);
